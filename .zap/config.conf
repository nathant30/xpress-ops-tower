# ZAP Configuration for Xpress Ops Tower Security Testing

# Spider configuration
spider.maxDuration=10
spider.maxDepth=5
spider.maxChildren=100
spider.acceptCookies=true
spider.handleParameters=true
spider.parseComments=true
spider.parseRobotsTxt=true
spider.handleODataParametersVisited=false

# Authentication configuration
auth.method=form
auth.loginUrl=http://localhost:3000/api/auth/login
auth.usernameParameter=email
auth.passwordParameter=password
auth.username=test@example.com
auth.password=testpassword123
auth.loggedInIndicator=dashboard
auth.loggedOutIndicator=login

# Active scanner configuration
ascan.strength=MEDIUM
ascan.alertThreshold=MEDIUM
ascan.maxRuleDurationInMins=5
ascan.maxScanDurationInMins=30
ascan.delayInMs=200
ascan.threadsPerHost=2

# Passive scanner configuration
pscan.enabled=true
pscan.maxAlertsPerRule=10

# Session management
session.defaultSessionTokens=JSESSIONID,ASP.NET_SessionId,PHPSESSID,sessionid,session_id

# Technology detection
tech.detect=true

# Custom headers for API testing
headers.custom.Authorization=Bearer test-token
headers.custom.X-API-Key=test-api-key
headers.custom.Content-Type=application/json
headers.custom.User-Agent=ZAP-Security-Scanner/2.14

# Anti-CSRF token handling
anticsrf.enabled=true
anticsrf.tokens=_token,csrftoken,csrf_token,authenticity_token

# Context configuration for different app areas
context.emergency.name=Emergency System
context.emergency.includePaths=http://localhost:3000/api/emergency/.*
context.emergency.excludePaths=http://localhost:3000/api/emergency/health

context.auth.name=Authentication System
context.auth.includePaths=http://localhost:3000/api/auth/.*
context.auth.excludePaths=http://localhost:3000/api/auth/health

context.api.name=General API
context.api.includePaths=http://localhost:3000/api/.*
context.api.excludePaths=http://localhost:3000/api/health.*

# Custom attack patterns for rideshare systems
attack.custom.gps_spoofing=lat=999&lng=999
attack.custom.location_manipulation=latitude=91.0&longitude=181.0
attack.custom.driver_id_manipulation=driverId=../../../etc/passwd
attack.custom.booking_manipulation=bookingId='1 OR 1=1--
attack.custom.emergency_bypass=emergency=true&bypass=admin

# Rate limiting configuration
rateLimit.enabled=true
rateLimit.requestsPerSecond=10
rateLimit.delayBetweenRequests=100

# Reporting configuration
report.template=traditional-html
report.confidence.minimum=MEDIUM
report.risk.minimum=MEDIUM

# Proxy configuration
proxy.chainedProxies=false
proxy.modifyHeaders=true
proxy.removeHeaders=false

# Database configuration for persistent sessions
database.compact=true
database.recoverylog=false

# Extensions configuration
ext.quickstart.enabled=true
ext.activescan.enabled=true
ext.passivescan.enabled=true
ext.spider.enabled=true
ext.bruteforce.enabled=false
ext.fuzz.enabled=false

# Custom scan policies for different areas
scanpolicy.emergency.name=Emergency System Policy
scanpolicy.emergency.strength=HIGH
scanpolicy.emergency.alertThreshold=LOW
scanpolicy.emergency.maxRuleDurationInMins=10

scanpolicy.auth.name=Authentication Policy  
scanpolicy.auth.strength=HIGH
scanpolicy.auth.alertThreshold=LOW
scanpolicy.auth.maxRuleDurationInMins=8

scanpolicy.api.name=API Security Policy
scanpolicy.api.strength=MEDIUM
scanpolicy.api.alertThreshold=MEDIUM
scanpolicy.api.maxRuleDurationInMins=5

# Performance settings
performance.maxBodySizeInBytes=1048576
performance.maxResponseTimeInMs=30000
performance.connectionTimeout=60000
performance.readTimeout=60000

# Security-specific settings
security.validateCertificates=true
security.followRedirects=true
security.maxRedirects=3
security.handleGzipEncodedResponse=true