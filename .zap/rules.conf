# ZAP Security Scan Rules Configuration for Xpress Ops Tower
# This file configures the OWASP ZAP security scanner rules

# Rule configurations (IGNORE, WARN, FAIL)
# IGNORE: Rule will be ignored
# WARN: Rule failure will be reported but won't fail the build
# FAIL: Rule failure will fail the build

# Authentication and Session Management
10010	WARN	# Cookie No HttpOnly Flag
10011	FAIL	# Cookie Without Secure Flag
10016	FAIL	# Web Browser XSS Protection Not Enabled
10017	FAIL	# Cross-Domain JavaScript Source File Inclusion
10020	WARN	# X-Frame-Options Header Not Set
10021	FAIL	# X-Content-Type-Options Header Missing
10023	WARN	# Information Disclosure - Debug Error Messages
10024	WARN	# Information Disclosure - Sensitive Information in URL
10025	WARN	# Information Disclosure - Sensitive Information in HTTP Referrer Header
10026	WARN	# HTTP Parameter Override
10027	WARN	# Information Disclosure - Suspicious Comments
10028	WARN	# Open Redirect
10029	WARN	# Cookie Poisoning
10030	WARN	# User Controllable Charset
10031	WARN	# User Controllable HTML Element Attribute (Potential XSS)
10032	WARN	# Viewstate without MAC Signature
10033	WARN	# Directory Browsing
10034	WARN	# Heartbleed OpenSSL Vulnerability
10035	FAIL	# Strict-Transport-Security Header Not Set
10036	FAIL	# Server Leaks Version Information via "Server" HTTP Response Header Field
10037	FAIL	# Server Leaks Information via "X-Powered-By" HTTP Response Header Field
10038	WARN	# Content Security Policy (CSP) Header Not Set
10039	WARN	# X-Backend-Server Header Information Leak
10040	FAIL	# Secure Pages Include Mixed Content
10041	WARN	# HTTP to HTTPS Insecure Transition in Form Post
10042	WARN	# HTTPS to HTTP Insecure Transition in Form Post
10043	WARN	# User Controllable JavaScript Event (XSS)
10044	WARN	# Big Redirect Detected (Potential Sensitive Information Leak)
10045	WARN	# Source Code Disclosure - /WEB-INF folder
10046	WARN	# Source Code Disclosure - Git folder
10047	WARN	# Source Code Disclosure - SVN folder
10048	WARN	# Remote Code Execution - Shell Shock
10049	WARN	# Content Cacheability
10050	WARN	# Retrieved from Cache
10051	WARN	# Relative Path Confusion
10052	WARN	# X-ChromeLogger-Data (XCLD) Header Information Leak
10053	WARN	# Apache Range Header DoS (CVE-2011-3192)
10054	FAIL	# Cookie without SameSite Attribute
10055	WARN	# CSP Scanner (Mixed Content)
10056	WARN	# X-Debug-Token Information Leak
10057	WARN	# Username Hash Found
10058	WARN	# GET for POST
10059	WARN	# Multiple X-Forwarded-For Headers
10060	WARN	# Source Code Disclosure - CVS
10061	WARN	# WSDL File Detection
10062	WARN	# PII Scanner
10063	WARN	# Permissions Policy Header Not Set
10096	WARN	# Timestamp Disclosure
10097	WARN	# Hash Disclosure
10098	WARN	# Cross-Domain Misconfiguration
10099	WARN	# Source Code Disclosure

# Injection Vulnerabilities
40003	FAIL	# CRLF Injection
40008	FAIL	# Parameter Tampering
40009	FAIL	# Server Side Include
40012	FAIL	# Cross Site Scripting (Reflected)
40013	FAIL	# Session Fixation
40014	FAIL	# Cross Site Scripting (Persistent)
40016	FAIL	# Cross Site Scripting (Persistent) - Prime
40017	FAIL	# Cross Site Scripting (Persistent) - Spider
40018	FAIL	# SQL Injection
40019	FAIL	# SQL Injection - MySQL
40020	FAIL	# SQL Injection - Hypersonic SQL
40021	FAIL	# SQL Injection - Oracle
40022	FAIL	# SQL Injection - PostgreSQL
40023	FAIL	# Possible Username Enumeration
40024	FAIL	# SQL Injection - SQLite
40025	FAIL	# Proxy Disclosure
40026	FAIL	# Cross Site Scripting (DOM Based)
40027	FAIL	# SQL Injection - MsSQL
40028	FAIL	# LDAP Injection
40029	FAIL	# Trace.axd Information Leak
40030	WARN	# Blind SQL Injection - MySQL
40031	WARN	# Blind SQL Injection - Oracle
40032	WARN	# Blind SQL Injection - PostgreSQL
40033	WARN	# Blind SQL Injection - SQLite
40034	WARN	# .NET Viewstate Information Leak
40035	WARN	# Hidden File Finder
40036	WARN	# Server Side Template Injection
40037	WARN	# Remote File Inclusion
40038	WARN	# Java Serialization Object

# Business Logic and Custom Rules
90001	WARN	# Insecure JSF ViewState
90002	WARN	# Java Serialization Object in HTTP Message
90003	WARN	# Sub Resource Integrity Attribute Missing
90004	WARN	# Insufficient Site Isolation Against Spectre Vulnerability
90005	WARN	# Sec-Fetch-Dest Header is Missing
90006	WARN	# Sec-Fetch-Site Header is Missing
90007	WARN	# Sec-Fetch-User Header is Missing
90008	WARN	# Deprecation Header is Missing
90009	WARN	# Content Security Policy violations
90010	WARN	# Modern Web Application
90011	FAIL	# Charset Mismatch
90017	WARN	# XSLT Injection
90018	WARN	# SQL Injection - Hypersonic SQL (Time Based)
90019	FAIL	# Server Side Code Injection
90020	FAIL	# Remote OS Command Injection
90021	FAIL	# XPath Injection
90022	FAIL	# Application Error Disclosure
90023	FAIL	# XML External Entity Attack
90024	FAIL	# Generic Padding Oracle
90025	WARN	# Expression Language Injection
90026	FAIL	# SOAP Action Spoofing
90027	FAIL	# Cookie Slack Detector
90028	FAIL	# Insecure Authentication
90029	FAIL	# LDAP Injection
90030	FAIL	# SOAP XML Injection

# Custom exclusions for known false positives in the app
# Ignore certain paths that are expected to have different behavior
# /api/health - Health check endpoint should be accessible
# /api/status - Status endpoint for monitoring

# Scan Policy Configuration
scanner.strength=HIGH
scanner.level=HIGH
spider.maxDuration=5
spider.maxChildren=10
spider.maxDepth=5

# Authentication configuration (if needed)
# auth.method=form
# auth.loginUrl=http://localhost:3000/api/auth/login
# auth.username=test@example.com
# auth.password=testpassword
# auth.loginRequestData={"email":"test@example.com","password":"testpassword"}

# Session management
session.management=cookie

# Request/Response modifications
# Add any custom headers or modify requests if needed

# Reporting
report.format=HTML,XML,JSON
report.template=traditional-html

# Additional security checks specific to Node.js/Next.js applications
node.js.checks=true
react.checks=true
api.security.checks=true